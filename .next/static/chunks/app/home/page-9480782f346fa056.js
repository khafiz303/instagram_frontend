(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[951],{6635:function(e,t,a){Promise.resolve().then(a.bind(a,3885))},4619:function(e,t,a){"use strict";a.d(t,{N:function(){return s}});let s="http://46.101.192.129:1000"},3885:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return v}});var s=a(7821),o=a(8078),n=a(6878),c=a(168),l=a(3659),i=a(8888),r=a.n(i),d=a(4233),u=a(9211);function m(e){let{closeModal:t}=e,[a,l]=(0,o.useState)(null),[i,r]=(0,o.useState)("filter-original"),[d,m]=(0,o.useState)(1),[p,h]=(0,o.useState)(""),[g,f]=(0,o.useState)(null),{id:v}=(0,c.useParams)(),y=(0,n.I0)();return(0,c.useRouter)(),(0,s.jsxs)("div",{className:"card ".concat(null!==a?"active":""),children:[(0,s.jsxs)("div",{className:"header-post",children:[(0,s.jsx)("p",{onClick:t,children:"Cancel"}),(0,s.jsx)("p",{children:"Create story"}),(0,s.jsx)("p",{onClick:()=>{y((0,u.DZ)({selectedFile:a})),t()},children:"Send"})]}),(0,s.jsxs)("div",{className:"post-c-img",children:[(0,s.jsx)("input",{type:"file",id:"fileInput",onChange:e=>{let t=e.target.files[0];l(t),f(URL.createObjectURL(t))}}),null===a&&(0,s.jsx)("label",{htmlFor:"fileInput",className:"custom-file-label button",children:"Select from computer"})]}),a&&(0,s.jsx)("div",{className:"pic ".concat(1===d?"ai-t":""),children:(0,s.jsxs)("div",{className:"preview ".concat(i),children:[g&&(0,s.jsx)("img",{src:g,alt:"Selected"})," "]})})]})}var p=a(9699);function h(){let[e,t]=(0,o.useState)(null),[a,l]=(0,o.useState)("filter-original"),[i,r]=(0,o.useState)(1),[d,m]=(0,o.useState)(""),[p,h]=(0,o.useState)(null),[g,f]=(0,o.useState)(!1),[v,y]=(0,o.useState)(null),{id:x}=(0,c.useParams)(),j=(0,n.I0)();(0,c.useRouter)();let N=(0,n.v9)(e=>e.story.stories);console.log("",v);let k=e=>{y(e),f(!0)},w=(0,n.v9)(e=>{var t;return null===(t=e.auth.currentUser)||void 0===t?void 0:t.id}),S=e=>{j((0,u.LA)(e)),f(!1)};return(0,s.jsxs)("div",{className:"stories",children:[N.map(e=>(0,s.jsx)("div",{className:"story",children:(0,s.jsx)("img",{src:"/images/ink.png",onClick:()=>k(e)})},e.id)),g&&v&&(0,s.jsxs)("div",{className:"modal",children:[(0,s.jsx)("div",{className:"modal-white-drop",onClick:()=>f(!1),children:" "}),(0,s.jsxs)("div",{className:"modal-inner",id:"modal-inner",children:[v.userId==w&&(0,s.jsx)("p",{className:"delete-story",onClick:()=>S(v.id),children:"X"}),(0,s.jsx)("div",{className:"main-img",children:(0,s.jsx)("img",{src:"http://46.101.192.129:1000".concat(v.imageUrl)})})]})]})]})}var g=a(3260),f=a(2841);function v(){let[e,t]=(0,o.useState)({}),[a,i]=(0,o.useState)(!1),v=(0,n.I0)(),y=(0,c.useRouter)(),x=(0,n.v9)(e=>{var t;return null===(t=e.auth.currentUser)||void 0===t?void 0:t.id}),j=(0,n.v9)(e=>e.post.allPost),N=(0,n.v9)(e=>e.auth.currentUser),k=(0,n.v9)(e=>e.profile.suggestions),w=(0,n.v9)(e=>e.post.likes);(0,o.useEffect)(()=>{v((0,l.Bd)()),v((0,u.vD)())},[v,w]),(0,o.useEffect)(()=>{v((0,f.vt)())},[v]);let S=e=>{let t=r()(),a=r()(e),s=t.diff(a,"minutes"),o=t.diff(a,"hours"),n=t.diff(a,"days"),c=t.diff(a,"months"),l=t.diff(a,"years");return s<60?"".concat(s,"м"):o<24?"".concat(o,"ч"):n<30?"".concat(n,"д"):c<12?"".concat(c,"м"):"".concat(l,"г")},Z=(e,a)=>{t(t=>({...t,[a]:e.target.value}))},C=a=>{v((0,l.Ir)({postId:a,text:e[a]})),t(e=>({...e,[a]:""}))},I=e=>{v((0,l.j)({id:e}))},b=e=>{v((0,l.Nk)(e))};return(0,s.jsx)("div",{className:"home",children:(0,s.jsxs)("div",{className:"home-left",children:[(0,s.jsxs)("div",{className:"header profile-header",children:[(0,s.jsx)("div",{className:"profile-header-logo",children:(0,s.jsx)("img",{src:"/images/logo-profile.png",alt:"Logo"})}),(0,s.jsxs)("div",{className:"header-search",children:[(0,s.jsx)("img",{src:"/images/vector.png",alt:"Search"}),(0,s.jsx)("input",{placeholder:"Search"})]}),(0,s.jsxs)("div",{className:"header-nav",children:[(0,s.jsx)("img",{src:"/images/plus-solid.svg",onClick:()=>i(!0),alt:"Create Story"}),(0,s.jsx)("img",{src:"/images/home.png",alt:"Home"}),(0,s.jsx)("img",{src:"/images/exit.svg",onClick:()=>{v((0,g.ni)()),y.push("/")},alt:"Logout"}),N&&(0,s.jsx)(d.default,{href:"/profile/".concat(N.username),children:(0,s.jsx)("img",{src:"/images/ink.png",alt:"Profile Picture"})})]})]}),(0,s.jsx)(h,{}),(0,s.jsx)("div",{className:"relative",children:(0,s.jsxs)("div",{className:"main",children:[j.map(t=>{var a,o,n;return(0,s.jsxs)("div",{className:"post",children:[(0,s.jsx)(d.default,{href:"/profile/".concat(null===(a=t.user)||void 0===a?void 0:a.fullName),children:(0,s.jsx)(p.Z,{username:null===(o=t.user)||void 0===o?void 0:o.fullName,imgSize:"imgSize",dop:"..."})}),(0,s.jsxs)("div",{className:"main-profile",children:[(0,s.jsxs)("div",{className:"main-img",children:[(0,s.jsx)("img",{src:"http://46.101.192.129:1000".concat(t.imageUrl),alt:"Post Image"}),(0,s.jsxs)("div",{className:"img-nav",children:[(0,s.jsxs)("div",{className:"img-nav-left",children:[t.likes.some(e=>e.userId===x)?(0,s.jsx)("img",{className:"like-icon",onClick:()=>{b(t.likes.find(e=>e.userId===x).id)},src:"/images/heart-icon.svg",alt:"Like Icon"}):(0,s.jsx)("img",{className:"like-icon",onClick:()=>I(t.id),src:"/images/heart-black.svg",alt:"Like Icon"}),(0,s.jsx)(d.default,{href:"/home/".concat(t.id),children:(0,s.jsx)("img",{className:"comment-img",src:"/images/Comment.png",alt:"Comment Icon"})})]}),(0,s.jsx)("div",{children:(0,s.jsx)("img",{src:"/images/izb.png",alt:"Save Icon"})})]})]}),(0,s.jsxs)("div",{className:"post-com",children:[(0,s.jsxs)("div",{className:"postDown",children:[(0,s.jsx)("p",{children:null===(n=t.user)||void 0===n?void 0:n.fullName}),(0,s.jsx)("p",{children:t.description})]}),(0,s.jsx)(d.default,{href:"/home/".concat(t.id),children:(0,s.jsxs)("p",{className:"comment-parag",children:["Посмотреть все комментарии: (",t.id&&t.comments.length,")"]})}),(0,s.jsx)("p",{children:S(t.createdAt)}),(0,s.jsxs)("div",{className:"add-comment",children:[(0,s.jsx)("input",{type:"text",placeholder:"add a comment",value:e[t.id]||"",onChange:e=>Z(e,t.id)}),(0,s.jsx)("p",{onClick:()=>C(t.id),children:"Post"})]})]})]})]},t.id)}),(0,s.jsxs)("div",{className:"rec",children:[(0,s.jsxs)("div",{className:"rec-all",children:[(0,s.jsx)("h2",{children:"Suggestions For You"}),(0,s.jsx)("p",{children:"See All"})]}),k&&k.map(e=>(0,s.jsx)(p.Z,{username:e.fullName,follow:"follow",link:"link"},e.id))]})]})}),a&&(0,s.jsx)("div",{className:"post-create",children:(0,s.jsx)(m,{setCreateStory:i,username:text,create:!0,edit:!1,closeModal:()=>i(!1)})})]})})}},3260:function(e,t,a){"use strict";a.d(t,{ni:function(){return d},uX:function(){return m},y1:function(){return u}});var s=a(8160),o=a(3598),n=a(3940),c=a(4619);let l={isAuth:!1,currentUser:null,tokenExt:0};{let e=localStorage.getItem("token");if(e){let t=(0,n.o)(e);1e3*t.exp>Date.now()?(l={isAuth:!0,currentUser:{id:t.id,email:t.email,username:t.username},tokenExt:t.exp},o.Z.defaults.headers.common.Authorization="Bearer ".concat(e)):localStorage.removeItem("token")}}let i=(0,s.oM)({name:"auth",initialState:l,reducers:{authorize:(e,t)=>{localStorage.setItem("token",t.payload.token),o.Z.defaults.headers.common.Authorization="Bearer ".concat(t.payload.token);let a=(0,n.o)(t.payload.token);e.currentUser={id:a.id,email:a.email,username:a.username},e.isAuth=!0,e.tokenExt=a.exp},logOut:e=>{e.isAuth=!1,e.currentUser=null,e.tokenExt=0,localStorage.removeItem("token")}}}),{authorize:r,logOut:d}=i.actions,u=(e,t,a)=>s=>{o.Z.post("".concat(c.N,"/api/auth/signup"),{email:e,password:t,username:a}).then(e=>{s(r(e.data))})},m=(e,t)=>a=>{o.Z.post("".concat(c.N,"/api/auth/login"),{email:e,password:t}).then(e=>{a(r(e.data))})};t.ZP=i.reducer},3659:function(e,t,a){"use strict";a.d(t,{Bd:function(){return w},Ir:function(){return N},Nk:function(){return Z},Q5:function(){return x},YF:function(){return k},dq:function(){return j},fR:function(){return y},gQ:function(){return f},j:function(){return S},qb:function(){return v}});var s=a(8160),o=a(3598),n=a(4619);let c=(0,s.oM)({name:"post",initialState:{posts:[],post:{comments:[]},allPost:[],likes:[]},reducers:{getMyPosts:(e,t)=>{e.posts=t.payload.posts},createMyPost:(e,t)=>{e.posts.push(t.payload.post)},deleteMyPost:(e,t)=>{let a=[...e.posts];a=a.filter(e=>e.id!==t.payload),e.posts=a},setPost:(e,t)=>{e.post=t.payload.post},setComment:(e,t)=>{let a=t.payload.comment;e.post.comments.push(a)},deletedComment:(e,t)=>{let a=e.post.comments.filter(e=>e.id!==t.payload);e.post.comments=a},setAllPosts:(e,t)=>{e.allPost=t.payload.postsAll},setLike:(e,t)=>{e.likes=[...e.likes,t.payload]},deletedLike:(e,t)=>{let a=[...e.likes];a.filter(e=>e.postId!=t.payload),e.likes=a}}}),{getMyPosts:l,createMyPost:i,deleteMyPost:r,setPost:d,setComment:u,deletedComment:m,setAllPosts:p,setLike:h,deletedLike:g}=c.actions,f=()=>async e=>{try{let t=await o.Z.get("".concat(n.N,"/api/posts/my"));e(l({posts:t.data}))}catch(e){alert("Запрос на сервер не удался")}},v=e=>async t=>{try{let a=await o.Z.post("".concat(n.N,"/api/post/create"),e);t(i({post:a.data}))}catch(e){alert("Запрос на сервер не удался")}},y=e=>async t=>{try{await o.Z.delete("".concat(n.N,"/api/post/delete/").concat(e)),t(r(e))}catch(e){alert("Запрос на сервер не удался")}},x=e=>async t=>{try{let a=await o.Z.get("".concat(n.N,"/api/post/").concat(e));t(d({post:a.data}))}catch(e){alert("Запрос на сервер не удался")}},j=(e,t)=>async a=>{console.log(e),console.log();try{await o.Z.put("".concat(n.N,"/api/post/").concat(e),t)}catch(e){console.log(e),alert("Запрос на сервер не удался")}},N=e=>async t=>{try{let a=await o.Z.post("".concat(n.N,"/api/add-comment"),e);t(u({comment:a.data}))}catch(e){console.log(e),alert("Запрос на сервер не удался")}},k=e=>async t=>{console.log("request id:",e);try{await o.Z.delete("".concat(n.N,"/api/delete-comment/").concat(e)),t(m(e))}catch(e){console.log(e),alert("Запрос на сервер не удался")}},w=()=>async e=>{try{let t=await o.Z.get("".concat(n.N,"/api/posts/all"));e(p({postsAll:t.data})),console.log("datd",t.data)}catch(e){console.log(e),alert("Запрос на сервер не удался")}},S=e=>async t=>{try{let a=await o.Z.post("".concat(n.N,"/api/post/like"),e);t(h(a.data))}catch(e){console.log(e),alert(e.response&&e.response.data.error)}},Z=e=>async t=>{try{await o.Z.delete("".concat(n.N,"/api/post/like/").concat(e)),t(g(e))}catch(e){console.log(e),alert("Запрос на сервер не удался")}};t.ZP=c.reducer},2841:function(e,t,a){"use strict";a.d(t,{$e:function(){return y},Ai:function(){return p},FH:function(){return f},PX:function(){return h},fv:function(){return v},nX:function(){return g},vt:function(){return x}});var s=a(8160),o=a(3598),n=a(4619);let c=(0,s.oM)({name:"profile",initialState:{profile:{},following:[],MyFollowing:[],followers:[],suggestions:[]},reducers:{setProfile:(e,t)=>{e.profile=t.payload},setFollowing:(e,t)=>{e.following=t.payload},setFollowers:(e,t)=>{e.followers=t.payload},addFollow:(e,t)=>{e.followers=[...e.followers,t.payload]},setMyFollowing:(e,t)=>{e.MyFollowing=t.payload},setSuggestions:(e,t)=>{e.suggestions=t.payload}}}),{setProfile:l,setFollowing:i,setFollowers:r,addFollow:d,setMyFollowing:u,setSuggestions:m}=c.actions,p=e=>async t=>{try{let a=await o.Z.get("".concat(n.N,"/api/user/").concat(e));t(l(a.data)),console.log(a.data)}catch(e){console.log(e)}},h=e=>async t=>{try{console.log("iddd",e);let a=await o.Z.post("".concat(n.N,"/api/follow"),{id:e});t(d(a.data))}catch(e){console.log(e)}},g=e=>async t=>{try{let a=await o.Z.get("".concat(n.N,"/api/users/").concat(e,"/following"));t(i(a.data))}catch(e){console.log(e,"jh,dgskvkv")}},f=e=>async t=>{try{let a=await o.Z.get("".concat(n.N,"/api/users/").concat(e,"/following"));t(u(a.data))}catch(e){console.log(e,"jh,dgskvkv")}},v=e=>async t=>{try{await o.Z.delete("".concat(n.N,"/api/unsubscribe/").concat(e))}catch(e){console.log(e)}},y=e=>async t=>{try{let a=await o.Z.get("".concat(n.N,"/api/users/").concat(e,"/followers"));t(r(a.data))}catch(e){console.log(e)}},x=()=>async e=>{try{let t=await o.Z.get("".concat(n.N,"/api/suggestions"));e(m(t.data))}catch(e){console.log(e)}};t.ZP=c.reducer},9211:function(e,t,a){"use strict";a.d(t,{DZ:function(){return u},LA:function(){return m},vD:function(){return d}});var s=a(8160),o=a(3598),n=a(4619);let c=(0,s.oM)({name:"story",initialState:{stories:[],story:[]},reducers:{getMyStories:(e,t)=>{e.stories=t.payload.stories},createMyStory:(e,t)=>{let a=[...e.stories,t.payload];e.stories=a},deleteMyStory:(e,t)=>{let a=[...e.stories];a=a.filter(e=>e.id!==t.payload),e.stories=a}}}),{getMyStories:l,createMyStory:i,deleteMyStory:r}=c.actions,d=()=>async e=>{try{let t=await o.Z.get("".concat(n.N,"/api/story"));e(l({stories:t.data}))}catch(e){alert("Запрос на сервер не удался")}},u=e=>async t=>{try{let a=new FormData;a.append("imageUrl",e.selectedFile);let s=await o.Z.post("".concat(n.N,"/api/story/create"),a,{headers:{"Content-Type":"multipart/form-data"}});t(i({story:s.data})),console.log("Story created successfully",s.data)}catch(e){console.error("Error creating story",e),alert("Запрос на сервер не удался")}},m=e=>async t=>{try{await o.Z.post("".concat(n.N,"/api/story/delete/").concat(e)),t(r(e))}catch(e){alert("Запрос на сервер не удался"),console.log(e)}};t.ZP=c.reducer},9699:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});var s=a(7821),o=a(8078),n=a(6878),c=a(3659),l=a(168);a(2841);var i=a(4233);function r(e){let{username:t,shadow:a,dop:r,text:d,remove:u,follow:m,size:p,imgSize:h,selectedPost:g,deleted:f,close:v,follower:y,myFollowing:x,following:j,link:N,userId:k}=e,[w,S]=(0,o.useState)(!1),Z=(0,l.useRouter)(),C=(0,n.I0)(),I=(0,n.v9)(e=>{var t;return null===(t=e.auth.currentUser)||void 0===t?void 0:t.id});return(0,s.jsxs)("div",{className:"user-mini ".concat(a," ").concat(p),children:[(0,s.jsxs)("div",{className:"user-m-img",children:[(0,s.jsx)("img",{src:"/images/ink.png",alt:"Profile Picture",className:h}),!m&&(0,s.jsx)("p",{children:t}),m&&(0,s.jsx)("div",{className:"df",children:N?(0,s.jsx)(i.default,{href:"/profile/".concat(t),children:(0,s.jsx)("p",{children:t})}):(0,s.jsx)("p",{children:t})})]}),(0,s.jsxs)("div",{children:[d&&(0,s.jsx)("p",{children:d}),r&&k==I&&(0,s.jsx)("span",{onClick:()=>{S(!0)},children:r}),u&&(0,s.jsx)("button",{className:"button btn-mini",onClick:f,children:u?"remove":""})]}),w&&(0,s.jsxs)("div",{className:"toggle",children:[(0,s.jsx)("div",{onClick:()=>Z.push("/edit-post/"+g),children:(0,s.jsx)("p",{children:"Edit"})}),(0,s.jsx)("div",{children:(0,s.jsx)("p",{onClick:()=>{C((0,c.fR)(g)),v()},children:"Delete"})})]})]})}},3940:function(e,t,a){"use strict";a.d(t,{o:function(){return o}});class s extends Error{}function o(e,t){let a;if("string"!=typeof e)throw new s("Invalid token specified: must be a string");t||(t={});let o=!0===t.header?0:1,n=e.split(".")[o];if("string"!=typeof n)throw new s(`Invalid token specified: missing part #${o+1}`);try{a=function(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw Error("base64 string is not of the correct length")}try{var a;return a=t,decodeURIComponent(atob(a).replace(/(.)/g,(e,t)=>{let a=t.charCodeAt(0).toString(16).toUpperCase();return a.length<2&&(a="0"+a),"%"+a}))}catch(e){return atob(t)}}(n)}catch(e){throw new s(`Invalid token specified: invalid base64 for part #${o+1} (${e.message})`)}try{return JSON.parse(a)}catch(e){throw new s(`Invalid token specified: invalid json for part #${o+1} (${e.message})`)}}s.prototype.name="InvalidTokenError"}},function(e){e.O(0,[386,314,178,115,205,744],function(){return e(e.s=6635)}),_N_E=e.O()}]);